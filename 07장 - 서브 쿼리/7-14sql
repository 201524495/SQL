/**

*/
SELECT JOB, AVG(SAL)
FROM EMP
GROUP BY JOB;

SELECT E.DEPTNO, E.ENAME, E.JOB, E.SAL
FROM EMP E
WHERE E.SAL 
    < (SELECT AVG(EM.SAL) FROM EMP EM WHERE E.JOB = EM.JOB GROUP BY EM.JOB)
ORDER BY E.JOB, E.SAL;